(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{204:function(e,t,r){"use strict";r.r(t);r(14),r(10),r(124),r(27);var n=r(4),o=(r(66),r(5)),l={middleware:"not-auth",head:function(){return{title:this.$t("pages.login.title"),htmlAttrs:{lang:this.$store.state.locale},meta:[{hid:"description",name:"description",content:this.$t("pages.login.description")}]}},data:function(){return{loggingIn:!1,email:"",rememberMe:!1}},mounted:function(){this.rememberMe=this.$route.query.hasOwnProperty("remember-me")},watch:{rememberMe:function(e,t){if(e!==t){var r={query:{}};e&&(r.query["remember-me"]=null),this.$router.replace(r).catch(o.A)}}},methods:{login:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n,l,m,c,d,f;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e.preventDefault(),t.loggingIn=!0,n=e.target[0].value,l=e.target[1].value,m=e.target[2].checked,t.$store.dispatch("hideMessage"),r.prev=6,r.next=9,t.$post("/login",{email:n,password:l,remember_me:Boolean(m)});case 9:return c=r.sent,r.next=12,c.json();case 12:if(d=r.sent,c.ok){r.next=18;break}return e.target[0].focus(),e.target[1].value="",d.errors?(f=Object.values(d.errors)[0][0],t.$store.dispatch("showMessage",{message:f,isError:!0})):t.$store.dispatch("showMessage",{message:d.message,isError:!0}),r.abrupt("return");case 18:m&&t.$store.commit("SET_REMEMBER_ME",{rememberMe:m}),localStorage.setItem("hasConnected",!0),t.$store.commit("SET_API_TOKEN",{apiToken:d.api_token}),t.$router.push("/").catch(o.A),r.next=28;break;case 24:r.prev=24,r.t0=r.catch(6),console.error("Error getting response",r.t0),t.$store.dispatch("showMessage",{message:t.$t("error.unknown"),isError:!0});case 28:return r.prev=28,t.loggingIn=!1,r.finish(28);case 31:case"end":return r.stop()}}),r,null,[[6,24,28,31]])})))()}},computed:{isProbablyClient:function(){return this.$store.state.isProbablyClient}}},m=r(13),component=Object(m.a)(l,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"mt-4 lg:mt-16 flex flex-col items-center"},[r("section",{staticClass:"flex flex-col items-center"},[r("img",{staticClass:"w-16 sm:mb-2 md:w-32",attrs:{src:"/images/naito-900.svg",alt:e.$t("alt.naito_one_logo")}}),e._v(" "),r("h1",{staticClass:"font-heading text-2xl text-center",domProps:{textContent:e._s(e.$t("pages.login.title"))}})]),e._v(" "),r("form",{staticClass:"my-8 flex flex-col items-center w-full sm:w-100 bg-gray-100 rounded-md px-4 py-8 font-medium",attrs:{action:"#"},on:{submit:e.login}},[r("label",{staticClass:"w-full",attrs:{for:"email-input"},domProps:{textContent:e._s(e.$t("global.email"))}}),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],staticClass:"w-full px-4 py-2 transparent-input",attrs:{disabled:e.loggingIn,type:"email",name:"email-input",id:"email-input",required:""},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),e._v(" "),r("div",{staticClass:"w-full pt-4 flex justify-between"},[r("label",{staticClass:"flex-grow flex items-center",attrs:{for:"password-input"},domProps:{textContent:e._s(e.$t("pages.login.form.password"))}}),e._v(" "),r("nuxt-link",{staticClass:"green-link text-right ml-4 p-4 md:p-0",attrs:{tabindex:"1",to:{name:"reset",query:{email:e.email}}},domProps:{textContent:e._s(e.$t("pages.login.form.forgotten_password"))}})],1),e._v(" "),r("input",{staticClass:"w-full px-4 py-2 transparent-input",attrs:{disabled:e.loggingIn,type:"password",name:"password-input",id:"password-input",required:""}}),e._v(" "),r("div",{staticClass:"w-full py-2 flex justify-end items-center"},[r("label",{staticClass:"select-none",attrs:{for:"remember-me-input"},domProps:{textContent:e._s(e.$t("pages.login.form.remember_me"))}}),e._v(" "),r("label",{staticClass:"material-checkbox text-naito-green-200",attrs:{for:"remember-me-input"}},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.rememberMe,expression:"rememberMe"}],attrs:{disabled:e.loggingIn,type:"checkbox",name:"remember-me-input",id:"remember-me-input"},domProps:{checked:Array.isArray(e.rememberMe)?e._i(e.rememberMe,null)>-1:e.rememberMe},on:{change:function(t){var r=e.rememberMe,n=t.target,o=!!n.checked;if(Array.isArray(r)){var l=e._i(r,null);n.checked?l<0&&(e.rememberMe=r.concat([null])):l>-1&&(e.rememberMe=r.slice(0,l).concat(r.slice(l+1)))}else e.rememberMe=o}}}),e._v(" "),r("div",{staticClass:"material-checkbox-fake material-checkbox-fake__large"})])]),e._v(" "),r("input",{class:["text-center","action",e.loggingIn?"action__processing":"","w-full","bg-naito-green-200","text-gray-100"],attrs:{disabled:e.loggingIn,type:"submit"},domProps:{value:e.$t("pages.login.form.submit")}})]),e._v(" "),e.isProbablyClient?e._e():r("a",{staticClass:"my-8 w-full sm:w-120 action bg-naito-blue-300 text-gray-100 text-center",attrs:{href:"https://naito.one/meters"},domProps:{textContent:e._s(e.$t("pages.login.new_client"))}})])}),[],!1,null,null,null);t.default=component.exports}}]);